# Automation Script for ZOpen Build Error Dataset Creation 

This repository contains an automation script designed to clone a GitHub repository, run a `zopen build`, capture logs, move patches, check build logs for errors, and handle patching and correcting code based on the error logs. The goal of this script is to streamline the process of building, detecting errors, and applying patches in a z/OS environment and making a dataset for LLM training.

## Features

- **Clone GitHub Repository**: Clones a specified GitHub repository to a specified destination directory.
- **Build Process**: Runs the `zopen build` command, captures detailed logs, and processes errors.
- **Error Checking**: Analyzes the build logs to detect errors and store them for further analysis.
- **Patch Management**: Moves patches to a temporary directory, applies patches to correct code, and deletes obsolete source files.
- **Log Handling**: Captures logs during the build process and saves them for further inspection.
- **Patch Application**: Automatically applies patches to correct errors in source code files.

## Requirements

**The script must be run in the Z/Os environment**
- **Python 3.9**
- **Git**: Ensure that Git is installed and available in your system's PATH.



## Usage

Clone the Repository and Run the Automation
### 1.	Run the automation script by providing the GitHub repository URL as an argument:

```
        python automation_script.py <clone_link> 
```

**clone_link should be the GitHub repository URL to clone.**

### 2.	The script will:
*	Clone the repository to the specified directory.
*	Move .c.patch and .h.patch files to a temporary directory.
*	Run the zopen build process.
*	Capture logs and save any errors to a temporary log file.
*	Analyze the logs for build errors and apply patches if necessary.
*	Save the error and code information to a .jsonl file for tracking.

## Configuration

The script looks for the following directory structure and files:
* **/data/students/Automation/temp**: Temporary directory where the repository is cloned, patches are moved, and build operations are performed.
* **/data/students/Automation/patches**: Directory where the patch files are moved and applied.
* **/data/students/Automation/temp/buildenv**: Configuration file that contains the build environment settings.
* **/data/students/data**: Directory where the JSONL files containing errors and code snippets are stored.

## Customization

You can customize the script by modifying the following parameters:
* **Source Folder Name**: The source folder name is extracted from the buildenv file. You can update the script to handle different environments or configurations.
* **Patch Directories**: The script checks specific directories for patches. You can adjust these paths to fit your project structure.

## Error Handling

The script includes error handling for the following situations:
* **Git Clone Errors**: If the Git repository cannot be cloned, an error message is displayed.
* **Build Errors**: If the zopen build fails, the log is analyzed to detect errors. The script will then attempt to apply patches to correct the issues.
* **Patch Application Errors**: If applying a patch fails, the script will notify you and stop further operations.
* **File Read/Write Errors**: If there are issues reading or writing files, appropriate error messages will be shown.

## Logging

The script captures the following logs:
* **Build Logs**: The build logs generated by zopen build are stored in the log.STABLE directory and saved to a temporary log file (temp_build_error.log).
* **Error Logs**: Errors detected during the build process are saved in a .jsonl file in the /data/students/data directory.


## Contact

If you have any questions or feedback, feel free to contact me at [prithivirajn25@gmail.com](prithivirajn25@gmail.com).

